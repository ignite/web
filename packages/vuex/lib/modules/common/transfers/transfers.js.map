{"version":3,"sources":["../../../../src/modules/common/transfers/transfers.js"],"names":["getDefaultState","GetTxsEvent","_Subscriptions","Set","state","namespaced","mutations","RESET_STATE","Object","assign","QUERY","query","key","value","JSON","stringify","SUBSCRIBE","subscription","add","UNSUBSCRIBE","getters","getGetTxsEvent","params","actions","init","dispatch","rootGetters","console","log","on","resetState","commit","unsubscribe","StoreUpdate","forEach","action","payload","ServiceGetTxsEvent","subscribe","all","values","axios","get","event","data","error","SpVuexError"],"mappings":"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","sourcesContent":["import axios from 'axios'\r\nimport  SpVuexError  from '../../../errors/SpVuexError';\r\n\r\nconst getDefaultState = () => {\r\n    return {\r\n        GetTxsEvent: {},\r\n        _Subscriptions: new Set(),\r\n    };\r\n};\r\n// initial state\r\nconst state = getDefaultState();\r\nexport default {\r\n    namespaced: true,\r\n    state,\r\n    mutations: {\r\n        RESET_STATE(state) {\r\n            Object.assign(state, getDefaultState());\r\n        },\r\n        QUERY(state, { query, key, value }) {\r\n            state[query][JSON.stringify(key)] = value;\r\n        },\r\n        SUBSCRIBE(state, subscription) {\r\n            state._Subscriptions.add(subscription);\r\n        },\r\n        UNSUBSCRIBE(state, subscription) {\r\n            state._Subscriptions.delete(subscription);\r\n        }\r\n    },\r\n    getters: {\r\n        getGetTxsEvent: (state) => (params = {}) => {\r\n            return state.GetTxsEvent[JSON.stringify(params)] ?? {}\r\n        }\r\n    },\r\n    actions: {\r\n        init({ dispatch, rootGetters }) {\r\n            console.log('Vuex nodule: common.transfers initialized!')\r\n            if (rootGetters['common/env/client']) {\r\n                rootGetters['common/env/client'].on('newblock', () => {\r\n                    dispatch('StoreUpdate');\r\n                });\r\n            }\r\n        },\r\n        resetState({ commit }) {\r\n            commit('RESET_STATE');\r\n        },\r\n        unsubscribe({ commit }, subscription) {\r\n            commit('UNSUBSCRIBE', subscription);\r\n        },\r\n        async StoreUpdate({ state, dispatch }) {\r\n            state._Subscriptions.forEach((subscription) => {\r\n                dispatch(subscription.action, subscription.payload);\r\n            });\r\n        },\r\n        async ServiceGetTxsEvent({ commit, rootGetters }, { subscribe = false, all=true,  ...key }) {\r\n            try {\r\n                let params=Object.values(key)\r\n                let value = (await axios.get(rootGetters['common/env/apiCosmos'] + '/cosmos/tx/v1beta1/txs?events='+key.event)).data;                \r\n                /*\r\n                while (all && value.pagination && value.pagination.next_key!=null) {\r\n                    let next_values=(await (await initQueryClient(rootGetters)).queryPostAll.apply(null,[...params, {'pagination.key':value.pagination.next_key}] )).data;\r\n                    \r\n                    for (let prop of Object.keys(next_values)) {\r\n                        if (Array.isArray(next_values[prop])) {\r\n                            value[prop]=[...value[prop], ...next_values[prop]]\r\n                        }else{\r\n                            value[prop]=next_values[prop]\r\n                        }\r\n                    }\r\n                    console.log(value)\r\n                }\r\n                */\r\n                commit('QUERY', { query: 'GetTxsEvent', key, value });\r\n                if (subscribe)\r\n                    commit('SUBSCRIBE', { action: 'ServiceGetTxsEvent', payload: key });\r\n            }\r\n            catch (e) {\r\n                console.error(new SpVuexError('QueryClient:ServiceGetTxsEvent', 'API Node Unavailable. Could not perform query.'));\r\n            }\r\n        },\r\n    }\r\n};\r\n"],"file":"transfers.js"}